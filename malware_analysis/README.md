# Malware Analysis Report

This repository contains the analysis of two Android malware samples (`malware_0.apk` and `malware_1.apk`) to identify suspicious behaviors and extract Command & Control (C2) infrastructure information.

## Analysis Summary

### malware_0.apk - Keylogger Analysis

**Identified Threat:** Keylogger
**Input Handling Technique:** Text field input monitoring via onValueChange callback with hidden file logging

#### Key Findings:
- **Malicious Behavior:** The application implements keylogging functionality to capture user input
- **Input Capture Method:** Uses Jetpack Compose TextField's `onValueChange` callback to monitor user text input
- **Data Storage:** Captured keystrokes are logged to a hidden file on the device
- **Stealth Mechanism:** Operates transparently without user awareness during normal text input operations

#### Technical Details:
- Utilizes Android Compose UI framework for input interception
- Implements file-based logging for persistence of captured data
- Designed to capture sensitive information like passwords, messages, and other text input

---

### malware_1.apk - C2 Communication Analysis

**Identified Threat:** Data Exfiltration Malware
**C2 Domain:** `http://malware-holberton.5dff3e7a8b.com`

#### Key Findings:
- **Malicious Behavior:** Establishes communication with remote Command & Control server for data exfiltration
- **Network Permissions:** App requests INTERNET permission in AndroidManifest.xml
- **Encryption Method:** Uses AES-256-CBC encryption to obfuscate the C2 domain
- **Communication Protocol:** HTTP GET requests to the C2 server

#### Technical Details:
- **Main Activity:** `com.holberton.malware_2.X9Z7Y5`
- **Encrypted C2 String:** `HAb89o3OWoajfpwW4SWjxzLAL7N46Yj0Bgxuj5MMKdBorCHsu_N3nFmGTpp7UxUe0JhHkYq2ef5tgKyt8Ua64A==`
- **Decryption Key:** `AZkdUHsd73LLEAIBS97367DHAKXNZVAY`
- **Encryption Algorithm:** AES-256-CBC with 16-byte IV
- **Decryption Process:** Base64 decode → AES decrypt → Plain text C2 domain

#### Network Communication Features:
- HTTP connection with 5-second timeout
- UTF-8 encoding for data transmission
- Error handling with logging capabilities
- Obfuscation techniques to hide malicious network activity

## Analysis Tools Used

- **APKTool:** For APK decompilation and resource extraction
- **Smali Code Analysis:** Manual examination of Android bytecode
- **Custom Decryption Script:** `decrypt_c2.py` for C2 domain extraction
- **Static Analysis:** Pattern matching and string extraction techniques

## Security Implications

1. **malware_0.apk:** Poses significant privacy risks by capturing sensitive user input including passwords and personal communications
2. **malware_1.apk:** Represents a data exfiltration threat with capability to communicate with remote attackers and potentially extract device data

Both malware samples demonstrate sophisticated techniques for evading detection and maintaining persistence on infected devices.